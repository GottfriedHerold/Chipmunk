% !TEX root = ../main.tex
\section{Preliminaries}\label{sec:prelim}
This section introduces notation, some basic definitions and a few basic lemmas that we will use throughout this work.
We denote by $\secpar\in\NN$ the security parameter and by $\poly$ any function that is bounded by a polynomial in $\secpar$.
A function $f$ in $\secpar$ is negligible, if for every $c \in \NN$, there exists some $N\in\NN$, such that for all $\secpar>N$ it holds that $f(\secpar) < 1/\secpar^c$.
We denote by $\negl$ any negligible function.
An algorithm is PPT if it is modeled by a probabilistic Turing machine with a running time bounded by $\poly$.

Let $X$ be a set.
We write $x\gets X$ for the process of sampling an element of $X$ uniformly at random.
Let $n\in\NN$, we denote by $\interval{n}$ the set $\{1,\dots,n\}$.
Let $T$ be a full binary tree of depth $d$.
We denote the root node of $T$ by the empty string $\epsilon$, and for any node $v$, $v\concat 0$ and $v\concat 1$ denotes the left and right child of $v$ respectively.
In particular, $\bin^d$ is the set of leaves of $T$.
A labeled full binary tree with labels in $X$ is represented by a labeling function $\lbl : \bin^{\leq d} \to X$.

Let $\vec{v},\vec{u}$ be vectors.
We write $\vec{v}^\transpose$ to denote the transpose of $\vec{v}$ and $v_i$ to denote the $i$-th entry in the vector for $i\in\interval{\abs{\vec{v}}}$.
We generalize this notation and write $\vec{v}_{< i}$ to denote the $(i-1)$-length prefix of $\vec{v}$.
We use the same notation for a bit-string $s$, denoting by $s_i$ the $i$-th bit and by $s_{<i}$ the prefix consisting of the first $i-1$ bits of $s$.
From time to time we will slightly abuse this notation and use a bit-string $s$ as an index.
In this case the index is to be understood as the canonical interpretation of $s$ as an integer in little-endian encoding.
\gnote{We actually mix 0-based indices and 1-based indices, so this is not true as stated here. This whole section needs discussion and review.}

We define the function $\zip$ that \enquote{zips} up two vectors into a single vector of pairs, i.e.
\[
\zip(\vec{a},\vec{b}) := \begin{pmatrix}(a_1,b_1)\\
\vdots\\
(a_\ell,b_\ell) \end{pmatrix}.
\]

\gnote{zip is only used once and much later in the document on page \pageref{fig:nidvconst}. The reader will have forgotten this. Maybe just spell it out at place of usage?}

% Without loss of generality, we work on a power-of-two cyclotomic polynomial ring.
Our concrete construction works over a power-of-two cyclotomic polynomial ring.
Let $\Phi_{2n} = x^n+1$ be the cyclotomic polynomial with $n$ a power of 2. 
We work in the polynomial ring $\ring =  \ZZ[x]/\langle x^n+1\rangle$ and represent elements of $\ring$ as $n$-dimensional vectors $\ZZ^n$ with $(c_0,\dots,c_{n-1})^\transpose\in \ZZ^n$ representing the ring element $\sum_{i=0}^{n-1} x^i \cdot c_i$.
For any odd prime number $q$, we always represent $\ZZ_q$ by the set $\{-\tfrac{q-1}{2},\ldots,\tfrac{q-1}{2}\}$ centered around 0.
Let $q$  be some prime such that $q \equiv 1 \bmod 2n$.
$\ring_q$ refers to the quotient ring of $\ring$ modulo $q$, represented by vectors in $\ZZ_q^n$. We can interpret these as elements from $\ring$ by taking representatives centered around 0 as above.
Let $x = \vec{c} \in \ring$ be a ring element.
We define norms $\norm{x} = \norm{\vec{c}}_\infty = \max_{i}\abs{c_i}$ and $\norm{x}_1 = \norm{\vec{c}}_1 = \sum_{i}\abs{x_i}$ on $\ring$ by taking the norm of the coefficient vector in the monomial basis.
We extend these definitions to norms on $\ring_q$ using coefficients in $\{-\tfrac{q-1}{2},\ldots,\tfrac{q-1}{2}\}$.

We denote by $\ball{\beta}{q}$ the ball $\ball{\beta}{q} = \{a\in\ring_q\mid \norm{a}\leq\beta\}$. We will always have $\beta < \tfrac{q}{2}$. By 
$\tern_\alpha = \{a=(a_0+a_1\cdot x + \dots + a_{n-1}x^{n-1}) \in\ring \mid \norm{a}_\infty\leq 1 \land \sum_{i=0}^{n-1} \abs{a_i} = \alpha\}$ %Note (Gotti): Making the \infty-norm explicit in \tern, but not in \ball is intentional.
we denote the set of polynomials with ternary coefficients, i.e. coefficients from $\{-1,0,1\}$, with exactly $\alpha$ non-zero coefficients.


Observe that for our choices of ring $\ring$ and norm, for any $a\in\ring$, we have $\norm{a} = \norm{X\cdot a}$, because multiplication by $X$ acts on the coefficient vector as a cyclic shift (up to sign).
For such rings and norms, we can make use of the following simple lemma that allows us to bound the norm of the product of two polynomials.
\begin{lemma}[\cite{Mic07}]\label{lem:ternbound}
  Let $a,b\in\ring$ be two polynomials. Then $\norm{b\cdot a} \leq \norm{a}_1\cdot\norm{b}$.
\end{lemma}

The security of our constructions relies on the hardness of the short integer solution problem defined over rings as follows.
\begin{definition}[Ring Short Integer Solution Problem]
  For a ring $\ring$ and parameters $\mu,q,\beta \in \NN$, the $\sis_{\ring,q,\mu,\beta}$ problem is hard if for all PPT algorithms $\adv$ it holds that
  \[
    \Pr[
      \vec{a} \gets \ring_q^\mu; \vec{s}\gets\adv(\vec{a}) : \vec{s}\in\ball_\beta^\mu\setminus\{\vec{0}\} \land \vec{a}^\transpose\vec{s}=0
    ] \leq \negl
  \]
\end{definition}

Our construction depends on a significant number of tunable parameters, whose choice affects both security, efficiency and functionality. \autoref{table:meaning_of_parameters} gives an overview and is intended as a reference to aid the reader.

\begin{table}
\centering
\begin{tabular}{c@{\hskip 2ex}l}
 parameter & meaning\\\toprule
 $n$ & dimension of the ring we are working over; a power of 2.\\
 $\norm{.}$ & infinity-norm. For polynomials, we use monomial coordinates.\\
 $\ring$ & polynomial ring $\ring = \ZZ[X]/\langle X^n + 1\rangle$\\
 $\ring_q$ & polynomial ring $\ring = \ZZ_q[X]/\langle X^+n + 1\rangle$, where we work modulo $q$.\\
 $q$ & prime number. Our HVC uses works modulo $q$, i.e. with $\ring_q$ \\
  & Note that it can be used to commit to elements from $\ring_{q'}$\\
 $q'$ & prime number. Our key-homomorphic one-time signature scheme works modulo $q'$.\\
\end{tabular}

 
\label{table:meaning_of_parameters}
 \caption{Parameters using in our concrete scheme}
\end{table}
